# RSAå¤§ç¤¼åŒ…ç ´è§£æŠ¥å‘Š

## ä¸€ã€é¢˜ç›®æè¿°åŠèƒŒæ™¯ä»‹ç»

RSA å¯†ç ç®—æ³•æ˜¯ä½¿ç”¨æœ€ä¸ºå¹¿æ³›çš„å…¬é’¥å¯†ç ä½“åˆ¶ã€‚è¯¥ä½“åˆ¶ç®€å•ä¸”æ˜“äºå®ç°ï¼Œåªéœ€è¦é€‰æ‹© 5 ä¸ªå‚æ•°å³å¯ï¼ˆä¸¤ä¸ªç´ æ•°$p$å’Œ$q$ã€æ¨¡æ•°$N=pq$ï¼ŒåŠ å¯†æŒ‡æ•°ğ‘’å’Œè§£å¯†æŒ‡æ•°ğ‘‘ï¼‰ã€‚è®¾ğ‘šä¸ºå¾…åŠ å¯†æ¶ˆæ¯ï¼ŒRSA ä½“åˆ¶ç ´è¯‘ç›¸å½“äºå·²çŸ¥$ğ‘š^ğ‘’ \pmod ğ‘$ï¼Œèƒ½å¦è¿˜åŸğ‘šçš„æ•°è®ºé—®é¢˜ã€‚ç›®å‰æ¨¡æ•°è§„æ¨¡ä¸º 2048 æ¯”ç‰¹çš„RSA ç®—æ³•ä¸€èˆ¬æƒ…å†µä¸‹æ˜¯å®‰å…¨çš„ï¼Œä½†æ˜¯å¦‚æœå‚æ•°é€‰å–ä¸å½“ï¼ŒåŒæ ·å­˜åœ¨è¢«ç ´è¯‘çš„å¯èƒ½ã€‚

æœ‰äººåˆ¶ä½œäº†ä¸€ä¸ª RSA åŠ è§£å¯†è½¯ä»¶ï¼ˆé‡‡ç”¨çš„ RSA ä½“åˆ¶çš„å‚æ•°ç‰¹ç‚¹æè¿°è§å¯†ç èƒŒæ™¯éƒ¨åˆ†ï¼‰ã€‚å·²çŸ¥è¯¥è½¯ä»¶å‘é€æŸä¸ªæ˜æ–‡çš„æ‰€æœ‰å‚æ•°å’ŒåŠ å¯†è¿‡ç¨‹çš„å…¨éƒ¨æ•°æ®ï¼ˆåŠ å¯†æ¡ˆä¾‹æ–‡ä»¶è¯¦è§é™„ä»¶ 3-1ï¼‰ã€‚Alice ä½¿ç”¨è¯¥è½¯ä»¶å‘é€äº†ä¸€ä¸ªé€šå…³å¯†è¯­ï¼Œä¸”æ‰€æœ‰åŠ å¯†æ•°æ®å·²ç»è¢«æˆªè·ï¼Œè¯·é—®èƒ½å¦ä»…ä»åŠ å¯†æ•°æ®æ¢å¤è¯¥é€šå…³å¯†è¯­åŠ RSA ä½“åˆ¶å‚æ•°ï¼Ÿå¦‚èƒ½è¯·ç»™å‡ºåŸæ–‡å’Œå‚æ•°ï¼Œå¦‚ä¸èƒ½è¯·ç»™å‡ºå·²æ¢å¤éƒ¨åˆ†å¹¶è¯´æ˜å‰©ä½™éƒ¨åˆ†ä¸èƒ½æ¢å¤çš„ç†ç”±ï¼Ÿ

### 1.1 RSAå¯†ç ç®—æ³•ä½“åˆ¶å‚æ•°é€‰å–ä»¥åŠåŠ è§£å¯†è¿‡ç¨‹

#### RSA ä½“åˆ¶å‚æ•°é€‰å–

1. æ¯ä¸ªä½¿ç”¨è€…ï¼Œä»»æ„é€‰æ‹©ä¸¤ä¸ªå¤§ç´ æ•°ğ‘å’Œğ‘ï¼Œå¹¶æ±‚å‡ºå…¶ä¹˜ç§¯$N=pq$
2. ä»¤$ğœ‘(ğ‘) = (ğ‘ âˆ’ 1)(ğ‘ âˆ’ 1)$ï¼Œé€‰æ‹©æ•´æ•°ğ‘’ï¼Œä½¿å¾—$GCD(ğ‘’,ğœ‘(ğ‘)) = 1$ï¼Œå¹¶æ±‚å‡ºğ‘’æ¨¡ğœ‘(ğ‘)çš„é€†å…ƒğ‘‘ï¼Œå³$ğ‘’ğ‘‘ â‰¡ 1 mod ğœ‘(ğ‘)$.
3. å°†æ•°å¯¹(ğ‘’, ğ‘)å…¬å¸ƒä¸ºå…¬é’¥ï¼Œğ‘‘ä¿å­˜ä¸ºç§é’¥ã€‚

#### åŠ è§£å¯†è¿‡ç¨‹

Bob æ¬²ä¼ é€’æ˜æ–‡ğ‘šç»™ Aliceï¼Œåˆ™ Bob é¦–å…ˆç”±å…¬å¼€é€”å¾„æ‰¾å‡º Alice çš„å…¬é’¥(ğ‘’, ğ‘)ï¼ŒBob è®¡ç®—åŠ å¯†çš„ä¿¡æ¯ğ‘ä¸ºï¼š$ğ‘ â‰¡ ğ‘š^ğ‘’ \pmod ğ‘$ã€‚

Bob å°†å¯†æ–‡ğ‘ä¼ é€ç»™ Aliceã€‚éšå Alice åˆ©ç”¨è‡ªå·±çš„ç§é’¥ğ‘‘è§£å¯†ï¼š$ğ‘^d â‰¡ (ğ‘š^ğ‘’ )^ğ‘‘ â‰¡ ğ‘š^{ğ‘’ğ‘‘} â‰¡ ğ‘š \pmod ğ‘$ã€‚

### 1.2 æ³¨æ„ç‚¹ï¼š

1ï¼‰ æ¨¡æ•°ğ‘ = ğ‘ğ‘è§„æ¨¡ä¸º 1024 æ¯”ç‰¹ï¼Œå…¶ä¸­ğ‘ï¼Œğ‘ä¸ºç´ æ•°ï¼›

2ï¼‰ ç´ æ•°ğ‘ç”±æŸä¸€éšæœºæ•°å‘ç”Ÿå™¨ç”Ÿæˆï¼›

3ï¼‰ ç´ æ•°ğ‘å¯ä»¥éšæœºé€‰æ‹©ï¼Œä¹Ÿå¯ä»¥ç”± 2) ä¸­çš„éšæœºæ•°å‘ç”Ÿå™¨äº§ç”Ÿï¼›

4ï¼‰ å¯ä»¥å¯¹æ–‡æœ¬åŠ å¯†ï¼Œæ¯æ¬¡åŠ å¯†æœ€å¤š 8 ä¸ªæ˜æ–‡å­—ç¬¦ï¼›

5ï¼‰ æ˜æ–‡è¶…è¿‡ 8 ä¸ªå­—ç¬¦æ—¶ï¼Œå¯¹æ˜æ–‡åˆ†ç‰‡ï¼Œæ¯ä¸ªåˆ†ç‰‡ä¸è¶…è¿‡ 8 ä¸ªå­—ç¬¦ï¼›

6ï¼‰ åˆ†ç‰‡æ˜æ–‡å¡«å……ä¸º 512 æ¯”ç‰¹æ¶ˆæ¯åå†è¿›è¡ŒåŠ å¯†ï¼Œå¡«å……è§„åˆ™ä¸ºé«˜ä½æ·»åŠ  64 æ¯”ç‰¹æ ‡å¿—ä½ï¼ŒéšååŠ ä¸Š 32 æ¯”ç‰¹é€šä¿¡åºå·ï¼Œå†æ·»åŠ è‹¥å¹²ä¸ª 0ï¼Œæœ€å 64 æ¯”ç‰¹ä¸ºæ˜æ–‡åˆ†ç‰‡å­—ç¬¦å¯¹åº”çš„ ASCII ç ï¼ˆæ³¨ï¼šå¡«å……æ–¹å¼å‚è§åŠ å¯†æ¡ˆä¾‹ï¼Œä½†æ³¨æ„æ¯æ¬¡é€šä¿¡çš„æ ‡å¿—ä½å¯èƒ½å˜åŒ–ï¼‰ï¼›

7ï¼‰ åˆ†ç‰‡åŠ å¯†åå‘é€ä¸€ä¸ªåŠ å¯†å¸§æ•°æ®ï¼Œå¸§æ•°æ®æ–‡ä»¶åç§°ä¸º FrameXXï¼Œå…¶ä¸­ XX è¡¨ç¤ºæ¥æ”¶åºå·ï¼Œè¯¥åºå·ä¸ä¸€å®šç­‰äºé€šä¿¡åºå·ï¼›

8ï¼‰ å¸§æ•°æ®çš„æ•°æ®æ ¼å¼å¦‚ä¸‹ï¼Œå…¶ä¸­æ•°æ®éƒ½æ˜¯ 16 è¿›åˆ¶è¡¨ç¤ºï¼Œç»“æ„å¦‚ä¸‹
$$
1024bitæ¨¡æ•°N | 1024bitåŠ å¯†æŒ‡æ•°e|1024bitå¯†æ–‡m^e \pmod N
$$


9ï¼‰ ç”±äº Alice åˆæ¬¡ä½¿ç”¨è¯¥è½¯ä»¶ï¼Œå¯èƒ½ä¼šé‡å¤å‘é€æŸä¸€æ˜æ–‡åˆ†ç‰‡ã€‚

### 1.3 ç ”ç©¶ç°çŠ¶

RSA çš„å®‰å…¨æ€§æ˜¯åŸºäºå¤§æ•´æ•°ç´ å› å­åˆ†è§£çš„å›°éš¾æ€§ï¼Œè€Œå¤§æ•´æ•°å› å­åˆ†è§£é—®é¢˜æ˜¯æ•°å­¦ä¸Šçš„è‘—åéš¾é¢˜ã€‚æ•°åŸŸç­›æ³•æ˜¯ç›®å‰ RSA æ”»å‡»çš„é¦–é€‰ç®—æ³•ã€‚åœ¨ 1999 å¹´ï¼Œä¸€å° Cray è¶…çº§ç”µè„‘ç”¨äº† 5 ä¸ªæœˆæ—¶é—´åˆ†è§£äº† 512 æ¯”ç‰¹é•¿çš„å¯†é’¥ã€‚åœ¨ 512 æ¯”ç‰¹ RSA ç®—æ³•ç ´è§£ 10 å¹´ä¹‹å,å³ 2009 å¹´ 12 æœˆ 9 æ—¥ï¼Œ768æ¯”ç‰¹ RSA ç®—æ³•å³ 232 æ•°ä½æ•°å­—çš„ RSA-768 è¢«åˆ†è§£ã€‚åˆ†è§£ä¸€ä¸ª 768 æ¯”ç‰¹RSA å¯†é’¥æ‰€éœ€æ—¶é—´æ˜¯ 512 ä½çš„æ•°åƒå€ï¼Œè€Œ 1024 æ¯”ç‰¹æ‰€éœ€æ—¶é—´åˆ™æ˜¯ 768æ¯”ç‰¹çš„ä¸€åƒå¤šå€ï¼Œå› æ­¤åœ¨çŸ­æ—¶é—´å†… 1024 æ¯”ç‰¹ä»ç„¶æ˜¯å®‰å…¨çš„ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œç›®å‰å¯¹äº RSA ç®—æ³•çš„æ”»å‡»ä¸»è¦æœ‰ä»¥ä¸‹æ–¹å¼:é€‰æ‹©å¯†æ–‡æ”»å‡»ã€å…¬å…±æ¨¡æ•°æ”»å‡»ã€ä½åŠ å¯†å¯†æŒ‡æ•°æ”»å‡»ã€ä½è§£å¯†æŒ‡æ•°æ”»å‡»ã€å®šæ—¶æ”»å‡»ç­‰ç­‰ï¼Œè¯¦ç»†çš„ RSA å®‰å…¨åˆ†æå‚è§æœ‰å…³æ–‡çŒ®ã€‚

## äºŒã€é’ˆå¯¹èµ›é¢˜çš„æ”»å‡»

é¦–å…ˆç”¨ç°æœ‰çš„åˆ†è§£å¤§æ•´æ•°çš„æ–¹æ³•å¯¹æ‰€æœ‰çš„æ¨¡æ•°è¿›è¡Œæµ‹è¯•

### 2.1 è´¹é©¬åˆ†è§£æ³•ï¼š

è´¹é©¬åˆ†è§£æ³•ç”¨äºpä¸qç›¸è¿‘çš„nï¼Œæ³¨æ„åˆ°$(p+q)^2-4n=(p-q)^2$ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å¾—çŸ¥$(p+q)/2$ä¸$\sqrt{N}$æ¥è¿‘ï¼Œï¼Œé€šè¿‡çˆ†ç ´è¿™ä¸ªå·®å€¼èƒ½å¤Ÿå®¹æ˜“åœ°è®¡ç®—å‡ºp+qï¼Œä»è€Œåˆ†è§£nã€‚

```python
from Crypto.Util.number import *
from gmpy2 import iroot
nec = open(f"./Frame14",'r').read()

n = int(nec[:len(nec)//3],16)
e = int(nec[len(nec)//3:len(nec)//3*2],16)
c = int(nec[len(nec)//3*2:],16)

a = iroot(n,2)[0]+1
for i in range(a,a+100000000):
    if iroot(i**2 - n,2)[1]:
        b = iroot(i**2 - n,2)[0]
        p = (i+b)
        q = (i-b)
        print(p)
        print(q)
        break

d = inverse(e,(p-1)*(q-1))
print(long_to_bytes(pow(c,d,n)).split(b'\x00')[-1])
```

### 2.2 Pollard p-1åˆ†è§£

Pollard's p âˆ’ 1 ç®—æ³•ç”±John Pollardåœ¨1974å¹´æå‡ºã€‚è¿™ä¸ªç®—æ³•è¦æ±‚Nä¸€ä¸ªå› å­æ˜¯$p-1$å…‰æ»‘çš„ï¼Œå³$p-1$æ˜¯ä¸€äº›å°äº$B$çš„å› å­çš„ä¹˜ç§¯ã€‚ä»¤æ•´æ•°$a$ä¸$p$äº’ç´ ï¼Œæ ¹æ®è´¹é©¬å°å®šç†ï¼š

$$
a^{k(p-1)}=1 \pmod p
$$

å³$\gcd(a^{k(p-1)}-1,n)$å¦‚æœä¸æ˜¯$1$æˆ–è€…$N$,åˆ™ä¸€å®šæ˜¯$p$çš„å€æ•°ã€‚åˆå› ä¸º$p-1$å…‰æ»‘ï¼Œé‚£ä¹ˆå­˜åœ¨$M=\prod_{q\leq B}q^{\left \lfloor \log _q B\right \rfloor}$ä½¿å¾—$(p-1)|M$ã€‚åœ¨ç®—æ³•ä¸­ï¼Œè€ƒè™‘$M=N!$æ—¢èƒ½æ»¡è¶³æ¡ä»¶åˆèƒ½æ–¹ä¾¿è®¡ç®—ã€‚

---

**Alg 1.  Pollard p-1ç®—æ³•**

---

**Input:** ***$N$***

**Output:** $p$

1. $a=2,x=2$

2. while True:

     $a=a^x \pmod N$

     $res=\gcd(a-1,N)$

     if $res \neq 1$ and $res \neq N$ : return $res$

     $n=n+1$


---

è¿™ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ˜¯$\mathcal{O}(B \log B \cdot \log^2 n)$ï¼Œé€‰å–æ›´å¤§çš„$B$éœ€è¦æ›´é•¿çš„è¿è¡Œæ—¶é—´ï¼Œæ›´å¯èƒ½æˆåŠŸåˆ†è§£$N$ã€‚

```python
# python2
from Crypto.Util.number import long_to_bytes
import gmpy2
nec = open(f"./Frame6",'r').read()

n = int(nec[:len(nec)//3],16)
e = int(nec[len(nec)//3:len(nec)//3*2],16)
c = int(nec[len(nec)//3*2:],16)


def Pollard_p_1(N):
    a = 2
    while True:
        f = a
        for n in range(1, 200000):
            f = gmpy2.powmod(f, n, N)
            if n % 2 == 0:
                d = gmpy2.gcd(f-1, N)
                if 1 < d < N:
                    return d
        print(a)
        a += 1

p = Pollard_p_1(n)
q = n // p
phi = (p-1) * (q-1)
d = gmpy2.invert(e,phi)
m = long_to_bytes(gmpy2.powmod(c,d,n)).split(b'\x00')[-1]
print(m)

'''
2: b' That is'
6: b' "Logic '
19: b'instein.'
'''
```



### 2.3 å…¬å› æ•°åˆ†è§£

å°è¯•å› æ•°ç¢°æ’æ³•ï¼Œå³å¯¹æ¯ä¸€ä¸ªnè®¡ç®—å…¬å› æ•°ï¼Œè‹¥èƒ½å¤Ÿè®¡ç®—å‡ºé0å…¬å› æ•°åˆ™èƒ½å¤Ÿç›´æ¥å°†ä¸¤ä¸ªnè¿›è¡Œåˆ†è§£ã€‚

```python
from Crypto.Util.number import *
from gmpy2 import invert
nec1 = open(f"./Frame1",'r').read()

n1 = int(nec1[:len(nec1)//3],16)
e1 = int(nec1[len(nec1)//3:len(nec1)//3*2],16)
c1 = int(nec1[len(nec1)//3*2:],16)

nec = open(f"./Frame18",'r').read()

n = int(nec[:len(nec)//3],16)
e = int(nec[len(nec)//3:len(nec)//3*2],16)
c = int(nec[len(nec)//3*2:],16)

p = GCD(n1,n)
q1 = n1 // p
q = n // p
d1 = invert(e1,(p-1)*(q1-1))
d = invert(e,(p-1)*(q-1))

print("1:",long_to_bytes(pow(c1,d1,n1)).split(b'\x00')[-1])# frame 1
print("18:",long_to_bytes(pow(c,d,n)).split(b'\x00')[-1])# frame 18
'''
1: b'. Imagin'
18: b'm A to B'
'''
```

### 2.4 å…±æ¨¡æ”»å‡»

å¯¹äºä½¿ç”¨äº†ç›¸åŒçš„nç›¸åŒmï¼Œä¸åŒeæ‰€å¯¹åº”çš„ä¸¤ä¸ªå¯†æ–‡ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡å…±æ¨¡æ”»å‡»åœ¨ä¸åˆ†è§£nçš„å‰æä¸‹æ±‚è§£å‡ºmã€‚
$$
c_1= m^{e_1}\pmod n\\
c_2=m^{e_2}\pmod n \\
$$
å·²çŸ¥ä»¥ä¸Šä¿¡æ¯ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ‰©å±•æ¬§å‡ é‡Œå¾—çš„æ–¹æ³•æ±‚å‡º$xe_1+ye_2=\gcd{(e_1,e_2)}$çš„æ–¹æ³•ï¼Œä½¿å¾—æ¨¡æ•°å˜å°ï¼Œè€Œä¸€èˆ¬gcdç­‰äº1æ—¶ï¼Œç›´æ¥æ±‚å¾—å°±æ˜¯mäº†å³$c_1^xc_2^y=m^{xe_1+ye_2}\pmod n=m$ã€‚

```python
from Crypto.Util.number import *
from gmpy2 import gcdext
nec = open(f"./Frame0",'r').read()

n = int(nec[:len(nec)//3],16)
e1 = int(nec[len(nec)//3:len(nec)//3*2],16)
c1 = int(nec[len(nec)//3*2:],16)

nec = open(f"./Frame4",'r').read()

n = int(nec[:len(nec)//3],16)
e2 = int(nec[len(nec)//3:len(nec)//3*2],16)
c2 = int(nec[len(nec)//3*2:],16)
g,a,b = (gcdext(e1,e2))
m = (pow(c1,a,n) * pow(c2,b,n))%n
print(long_to_bytes(m))

'''
0:b'My secre'
4:b'My secre'
'''
```

### 2.5 å°æŒ‡æ•°å¹¿æ’­æ”»å‡»

å¯¹äºe=3ä¸5çš„å‡ ä¸ªå¯†æ–‡ï¼Œå¦‚æœä»–ä»¬æ‰€å¯¹åº”çš„æ˜æ–‡ç›¸åŒï¼Œåˆ™å¯ä»¥é€šè¿‡å°æŒ‡æ•°å¹¿æ’­æ”»å‡»æ¥æ±‚è§£å‡ºmã€‚ç”¨è¿™ç§æ–¹æ³•åªæ±‚è§£å‡ºäº†e=5çš„5ä¸ªå¯†æ–‡å¯¹åº”çš„æ˜æ–‡ï¼Œæ±‚ä¸å‡ºe=3å¯¹åº”çš„æ˜æ–‡ï¼ŒåŸå› æ˜¯e=3çš„ä¸‰ä¸ªæ˜æ–‡ä¸åŒï¼Œè€Œe=5æ—¶äº”ä¸ªæ˜æ–‡ç›¸åŒã€‚

ä½¿ç”¨ä¸­å›½å‰©ä½™å®šç†ï¼Œæˆ‘ä»¬å¯ä»¥è§£å‡ºä¸€ä¸ª$C = c_i \pmod{n_i}$ï¼Œè€Œè¿™ä¸ª$C = m^5 \pmod {n_1n_2...n_5}$ï¼Œåˆå› ä¸º$m<n_i$ ï¼Œæ‰€ä»¥$C < n_1n_2...n_5$ï¼Œæ‰€ä»¥è¯¥å¼åœ¨ZZä¸Šæˆç«‹ï¼Œç›´æ¥å¯¹Cå¼€5æ¬¡æ–¹æ ¹å³å¯æ±‚å‡ºmã€‚

```python
from Crypto.Util.number import *
from gmpy2 import invert,iroot
from functools import reduce
nlist=
clist=
index=[3, 8, 12, 16, 20]
def CRT(mi, ai):
  M = reduce(lambda x, y: x * y, mi)
  ai_ti_Mi = [a * (M // m) * invert(M // m, m) for (m, a) in zip(mi, ai)]
  return reduce(lambda x, y: x + y, ai_ti_Mi) % M
def small_e_boardcast_attack(nlist , e , clist):
  m = CRT(nlist , clist)
  tmp = iroot(m , e)
  if tmp[1] == 1:
    return tmp[0]
  else:
    return 0

m = small_e_boardcast_attack(nlist,5,clist)
print(long_to_bytes(m).split(b'\x00')[-1])
'''
b't is a f'
'''
```

### 2.6 Coppersmithæ–¹æ³•

Coppersmithåœ¨1996å¹´ç»™å‡ºäº†ä¸€ç§å•å˜å…ƒæ¨¡å¤šé¡¹å¼æ–¹ç¨‹æ±‚å°å€¼è§£çš„ç»“è®ºåï¼Œç»è¿‡Howgrave-Grahamç­‰äººå®Œå–„ã€æ”¹è¿›é€æ¸æˆç†Ÿã€‚

Howgrave-Grahamå¼•å…¥äº†ä¸€ä¸ªååˆ†é‡è¦çš„å¼•ç†ç®€åŒ–äº†Coppersmithçš„è¯æ˜è¿‡ç¨‹ã€‚

**Howgrave-Graham å¼•ç†1**
    è®¾$g(x)$ä¸ºä¸€ä¸ªå…·æœ‰$\omega$é¡¹çš„å•å˜é‡å¤šé¡¹å¼ï¼Œmä¸ºä¸€ä¸ªæ­£æ•´æ•°ï¼Œè‹¥åŒæ—¶æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶ï¼š
$$
g(x_0) \equiv 0 \mod{N^m},\,\,|x_0| \leq X \notag\\
\| g(xX) \| \leq \dfrac{N^m}{\sqrt{\omega}} \notag
$$
â€‹	åˆ™$g(x)=0$åœ¨æ•´æ•°ä¸Šæˆç«‹ã€‚ 

#### 2.6.1 æ ¼

**å®šä¹‰ æ ¼(Lattice)**ï¼šæ ¼ $\mathcal{L}$ æ˜¯mç»´æ¬§æ°ç©ºé—´çš„ä¸€ä¸ªç¦»æ•£åŠ æ³•å­ç¾¤ï¼Œå…·ä½“æ¥è¯´ï¼Œæ ¼æ˜¯nä¸ªçº¿æ€§æ— å…³çš„éé›¶å‘é‡$(\boldsymbol{b}_1,\boldsymbol{b}_2 \dots \boldsymbol{b}_n )$çš„æ‰€æœ‰æ•´ç³»æ•°çº¿æ€§ç»„åˆæ„æˆçš„é›†åˆã€‚å³    
$$
\mathcal{L} ( \boldsymbol{B} ) = \biggl\{ \sum_{i=1}^{n} x_i \boldsymbol{b}_i \mid  x_i \in \mathbb{Z}, i=1,2\dots n \biggr\} \notag
$$
å…¶ä¸­ï¼Œ$m$æ˜¯æ ¼çš„ç»´æ•°ï¼Œ$n$æ˜¯æ ¼çš„ç§©ï¼Œé€šå¸¸æˆ‘ä»¬åªè€ƒè™‘æ»¡ç§©ï¼Œå³$m=n$çš„æƒ…å†µã€‚ä¸€ç»„çº¿æ€§æ— å…³çš„å‘é‡ $\boldsymbol{B}=(\boldsymbol{b}_1,\boldsymbol{b}_2 \dots \boldsymbol{b}_n )$è¢«ç§°ä¸ºæ ¼çš„ä¸€ç»„åŸºï¼Œ åŒä¸€ä¸ªæ ¼å¯ä»¥ç”±ä¸åŒçš„æ ¼åŸºå¼ æˆã€‚å®šä¹‰æ ¼ $\mathcal{L}$ çš„è¡Œåˆ—å¼ä¸ºï¼š$\det(\mathcal{L})=\sqrt{\det(\boldsymbol{B}^T \boldsymbol{B})}$  ã€‚ä»å‡ ä½•çš„æ„ä¹‰ä¸Šæ¥è¯´ï¼Œæ ¼åŸºçŸ©é˜µçš„è¡Œåˆ—å¼ä¸ºæ ¼çš„â€œä½“ç§¯â€ã€‚æˆ‘ä»¬é€šå¸¸æ ¹æ®æ ¼åŸºæ­£äº¤æ€§çš„å¥½åï¼Œé€šä¿—è®²å³ä¸ºæ ¼åŸºä¸­å‘é‡çš„ä¸¤ä¸¤å‚ç›´ç¨‹åº¦ï¼Œå°†æ ¼åŸºåˆ†ä¸ºâ€œä¼˜è´¨åŸºâ€å’Œâ€œåŠ£è´¨åŸºâ€ã€‚

å—é«˜æ–¯åœ¨äºŒç»´æ ¼ä¸­åšæ ¼åŸºçº¦ç®€çš„æ€è·¯å¯å‘ï¼ŒLenstraã€LEnstraã€Lov\'aszä¸‰äººå°†å…¶æ€è·¯æ‹“å±•åˆ°é«˜ç»´ï¼Œå¹¶åœ¨1982å¹´å…±åŒæå‡ºè‘—åçš„LLLæ ¼åŸºçº¦ç®€ç®—æ³•[LLL82]ï¼Œä»»æ„ç»™å®šä¸€ç»„æ ¼åŸºï¼Œæ­¤ç®—æ³•å¯åœ¨å¤šé¡¹å¼æ—¶é—´å†…å°†å…¶è½¬åŒ–ä¸ºæ­£äº¤æ€§è¾ƒå¥½çš„ä¼˜è´¨åŸºã€‚
**å®šä¹‰ (LLLç®—æ³•}ï¼š**è®¾ $\{\boldsymbol{b}_1,\boldsymbol{b}_2 \dots \boldsymbol{b}_n\in \mathbb{R}^m\}$ æ˜¯æ ¼ $\mathcal{L}$ çš„ä¸€ç»„åŸºï¼Œè‹¥æ»¡è¶³â€œSizeæ¡ä»¶â€å’Œå‚æ•°ä¸º $\delta$ çš„â€œLov\'aszæ¡ä»¶â€ $(1/4<\delta \leq 1)$ åˆ™ç§°è¿™ç»„æœ‰åºçš„åŸº $(\boldsymbol{b}_1,\boldsymbol{b}_2 \dots \boldsymbol{b}_n )$  æ˜¯ä»¥ $\delta$ ä¸ºå‚æ•°çš„LLLçº¦åŒ–åŸºã€‚

**å®šç†**
    è®¾æ ¼ $\mathcal{L}$ çš„ç§©ä¸º $d$ ï¼Œè¾“å…¥æ ¼ $\mathcal{L}$ çš„ä¸€ç»„æ ¼åŸºå‘é‡ $(\boldsymbol{b}_1,\boldsymbol{b}_2 \dots \boldsymbol{b}_d )$ ï¼Œç»è¿‡å¤šé¡¹å¼æ—¶é—´ $O(d^5\omega \log^3(B))$ ï¼Œ$B$ ä¸ºè¾“å…¥æ ¼åŸºçŸ©é˜µå‘é‡ä¸­æœ€å¤§çš„2-èŒƒæ•°ï¼Œé‚£ä¹ˆLLLç®—æ³•è¾“å‡ºä¸€ç»„çº¦ç®€åŸºæ»¡è¶³ 
$$
\|\boldsymbol{v}_i\| \leq 2^{\frac{d(d-1)}{4(d+1-i)}} \det (\mathcal{L} )^{\frac{1}{d+1-i}},1\leq i\leq d \notag
$$
Gram-Schmidtæ­£äº¤åŒ–æ˜¯ä¸€ç§å¸¸è§çš„å¾—åˆ°æ­£äº¤åŸºçš„æ–¹æ³•ï¼Œç”±äºæ•´æ•°æ ¼çš„ç‰¹æ€§ï¼Œè¿™ç§æ–¹æ³•å¹¶ä¸èƒ½ç›´æ¥åœ¨æ ¼ä¸­ä½¿ç”¨ï¼Œä½†ä»ç„¶å¯ä»¥é€šè¿‡æ­£äº¤åˆ†é‡çš„æ¦‚å¿µæè¿°Gram-Schmidtç»“æ„ã€‚å‡è®¾ï¼š $\widetilde{\boldsymbol{v}}_i$ æ˜¯$\boldsymbol{v}_i$ åœ¨$(\boldsymbol{v}_1,\boldsymbol{v}_2 \dots \boldsymbol{v}_n )^\bot $ æ‰€å¼ æˆç©ºé—´ä¸Šçš„å°„å½±ã€‚å°½ç®¡$\widetilde{B} =( \widetilde{\boldsymbol{v}}_1,\widetilde{\boldsymbol{v}}_2 \dots \widetilde{\boldsymbol{v}}_n ) $ä¸æ˜¯æ ¼$\mathcal{L}$çš„ä¸€ç»„åŸºï¼Œå¯ä»¥æ‹¿æ¥ç”¨ä½œè®¡ç®—å¾—åˆ°æ»¡è¶³çš„â€œSizeæ¡ä»¶â€å’Œâ€œLov\'aszæ¡ä»¶â€çš„ä¸€ç»„åŸº:

**Sizeæ¡ä»¶:**
$$
| u_{i,j} | = \dfrac{| \boldsymbol{v}_i \cdot \widetilde{\boldsymbol{v}}_j|}{|\widetilde{\boldsymbol{v}}_j |^2} \leq \dfrac{1}{2} \quad \forall 1 \leq j < i \leq n \notag
$$
**Lov\'aszæ¡ä»¶:**
$$
\|\widetilde{\boldsymbol{v}}_i + \mu_{i,i-1}\widetilde{\boldsymbol{v}}_{i-1}\|^2 \geq \dfrac{3}{4}\|\widetilde{\boldsymbol{v}}_{i-1}\|^2 \notag
$$
ä»¤$\mathcal{L}$è¡¨ç¤ºä¸€ä¸ªç»´æ•°æ˜¯$n$çš„æ ¼ï¼Œåˆ™$\mathcal{L}$çš„ä»»æ„ä¸€ç»„LLLçº¦ç®€åŸº$\boldsymbol{v}_1,\boldsymbol{v}_2 \dots \boldsymbol{v}_n$å…·æœ‰å¦‚ä¸‹ä¸¤æ¡æ€§è´¨:

$$
\prod_{i=1}^n \|\boldsymbol{v}_i\| \leq 2^{\frac{n(n-1)}{4}} \det (\mathcal{L}) \notag\\

  \|\boldsymbol{v}_j \| \leq 2^{\frac{i-1}{2}} \|\widetilde{\boldsymbol{v}}_i \| \quad \forall 1 \leq j < i \leq n \notag
$$
é™¤æ­¤ä¹‹å¤–ï¼ŒLLLçš„åˆå§‹å‘é‡ï¼Œå³å¾—åˆ°çš„è¿‘ä¼¼æœ€çŸ­å‘é‡æ»¡è¶³:
$$
\|\boldsymbol{v}_1\| \leq 2^{\frac{i-1}{4}} |\det(\mathcal{L})|^{\frac{1}{n}},\,\,\text{ä¸”}\|\boldsymbol{v}_1\| \leq 2^{\frac{i-1}{2}}\min\|\boldsymbol{v}\|
$$
LLLç®—æ³•å…·ä½“æ­¥éª¤ï¼šç»™å®šæ•´æ•°æ ¼åŸº $\boldsymbol{B} = (\boldsymbol{v}_1,\boldsymbol{v}_2\dots \boldsymbol{v}_n) \in \mathbb{Z}^{n\times n}$\\
a. è®¡ç®— $\boldsymbol{B} $ çš„Gram-Schmidtæ­£äº¤åŸº $\widetilde{\boldsymbol{B}}$
b. ä»¤ $\boldsymbol{B} \leftarrow{\text{SizeReduce(}\boldsymbol{B}\text{)}}$
c. å¦‚æœå­˜åœ¨ä¸ç¬¦åˆ Lov\'asz æ¡ä»¶çš„æƒ…å†µ(i.e.$\dfrac{3}{4}\|\widetilde{\boldsymbol{v}}_i \|^2 > \| \mu_{i,i+1}\,\widetilde{\boldsymbol{v}}_i + \widetilde{\boldsymbol{v}}_{i+1} \|^2 )$ï¼Œå°†ä¸ç¬¦åˆçš„ä¸¤ä¸ªåŸº($\widetilde{\boldsymbol{v}}_i,\widetilde{\boldsymbol{v}}_{i+1}$)è¿›è¡Œäº¤æ¢ï¼Œå¹¶ä¸”è¿”å›æ­¥éª¤aã€‚å¦åˆ™ï¼Œå³è¾“å‡º $\boldsymbol{B}$ã€‚

å…¶ä¸­SizeReduceå³å¯¹Gram-Schimtæ­£äº¤åŒ–ä¸­æ¯ä¸ª$j\in[2,n],i\in[j-1,1]$ï¼Œ$v_{j}=v_{j}-\lfloor \mu_{i,j}\rceil \cdot{v_{i}}$ï¼Œ$ u_{i,j}  = \dfrac{| \boldsymbol{v}_i \cdot \widetilde{\boldsymbol{v}}_j|}{|\widetilde{\boldsymbol{v}}_j |^2}$

#### 2.6.2 coppersmithæ±‚è§£å•å…ƒæ¨¡å¤šé¡¹å¼æ–¹ç¨‹

ç”±Howgrave-Grahamå¼•ç†ï¼Œå‡è®¾$F(x) = \sum_{i=0}^{d} a_i x^i \in \mathbb{Z}[x],\,\,x_0 \in \mathbb{Z}$æ˜¯$F(x) \equiv 0 (mod \,N)$çš„ä¸€ä¸ªå°æ ¹ï¼Œä¸”$|x_0|<X,\,X\in \mathbb{N}$ï¼Œå®šä¹‰å¦‚ä¸‹è¡Œå‘é‡ï¼š

$$
\boldsymbol{b}_F = (a_0,a_1X\dots a_{d-1}X^{d-1},a_dX^d)
$$
å¦‚æœ$\|\boldsymbol{b}_F\| < N/\sqrt{d+1}$ï¼Œé‚£ä¹ˆ$F(x_0) = 0$ã€‚ä¾æ®æ­¤ç»“è®ºæ„é€ å¤šé¡¹å¼ $G(x)$ ï¼š

ä»¤ $G_i(x) = Nx^i$ å¾—åˆ° $d+1$ é¡¹å¤šé¡¹å¼ï¼Œå¹¶ä¸”æ‰€æœ‰å¤šé¡¹å¼çš„æ ¹å‡ä¸º$x_0 \pmod{N}$ã€‚é‚£ä¹ˆå¯ä»¥é€šè¿‡$G_i(x)$å¾—åˆ°å¦‚ä¸‹çš„æ ¼$\mathcal{B}$:
$$
\mathcal{B}=\begin{bmatrix}
    N & 0 & \cdots & 0 & 0 \\
    0 & NX& \cdots &0&0 \\
    \vdots&\vdots& &\vdots&\vdots \\
    0 &0&\cdots&NX^{d-1}&0 \\
    a_0&a_1X& \cdots&a_{d-1}X^{d-1}&X^d \\
    \end{bmatrix}
$$
é€šè¿‡LLLç®—æ³•æˆ‘ä»¬å¯ä»¥å¾—åˆ°ä¸€ç»„è¿‘ä¼¼æœ€çŸ­çš„çº¦ç®€åŸºï¼Œå¦‚æœXæ»¡è¶³ï¼š
$$
X<N^{\frac{2}{d(d+1)}}/\sqrt{2}(d+1)^{\frac{1}{d}}
$$
ç”±ä¸Šè¿°LLLç†è®ºæˆ‘ä»¬å¯ä»¥è¯æ˜åœ¨æ•´æ•°æ„ä¹‰ä¸Šï¼Œæˆ‘ä»¬å¾—åˆ°çš„çº¦ç®€åçš„å¤šé¡¹å¼æ»¡è¶³ $G(x_0) = 0$ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥è½»æ˜“å¾—åˆ° $x_0$ ã€‚

#### 2.6.3 æ±‚è§£

å› æ­¤æˆ‘ä»¬éœ€è¦å°†rsaä¸Šçš„é—®é¢˜è½¬åŒ–ä¸ºä¸€ä¸ªæ±‚è§£æ¨¡æ–¹ç¨‹çš„å°è§£çš„é—®é¢˜ã€‚å½“e=3æ—¶ï¼Œè™½ç„¶mæœ¬èº«è¾ƒå¤§ï¼Œä½†æ˜¯mçš„ä¸ŠåŠéƒ¨åˆ†æˆ‘ä»¬å·²çŸ¥ï¼ŒæœªçŸ¥ä»…æœ‰ä¸€ä¸ªåºå·ä¸8å­—èŠ‚(64bit)çš„æ˜æ–‡ï¼Œåºå·å¯ä»¥ç›´æ¥çˆ†ç ´ã€‚è€Œ8å­—èŠ‚çš„æœªçŸ¥æ•°æ˜¯ä¸€ä¸ªå¾ˆå°çš„æ•°å­—ï¼Œå¯ä»¥æ„é€ å‡ºä¸€ä¸ªä»¥è¯¥8å­—èŠ‚æ•°ä¸ºæ ¹çš„å‡½æ•°ï¼Œé€šè¿‡è°ƒç”¨coppersmithçš„æ±‚æ ¹æ³•æ¥è§£å†³é—®é¢˜ã€‚

è®¾f = (app + m)^3 - c (mod n)ï¼Œappä¸ºmçš„é«˜ä½å·²çŸ¥æ•°ï¼Œåˆ™æˆ‘ä»¬å¯ä»¥é€šè¿‡coppersmithç®—æ³•æ¥æ±‚è§£å‡ºm 

```python
from Crypto.Util.number import *
def GetPrefix(i):
  res = '9876543210abcdef' + hex(i)[2:].rjust(8 , '0') + '0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000' + 16 * '0' 
  return int(res , 16)
nlist = 
clist = 
index = [7, 11, 15]
e = 3
for j in range(3):
  PR.<x> = PolynomialRing(Zmod(nlist[j]))
  for i in range(21):
    a = GetPrefix(i)
    f = (a + x) ^ e - clist[j]
    x0 = f.small_roots(X = 2^64 , beta = 1)
    if len(x0) != 0:
      print(index[j], i ,long_to_bytes(int(x0[0]))) 

'''
7 2 b'amous sa'
11 3 b'ying of '
15 4 b'Albert E'
'''
```

## ä¸‰ã€æœ€ç»ˆæ±‚è§£

Frame0: b'My secre'

Frame1: b'. Imagin'

Frame2: b' That is'

Frame3: b't is a f'

Frame4: b'My secre'

Frame5: 

Frame6: b' "Logic '

Frame7: b'amous sa'

Frame8: b't is a f'

Frame9: 

Frame10: b'will get'

Frame11: b'ying of '

Frame12:b't is a f'

Frame13: 

Frame14: b' you fro'

Frame15: b'Albert E'

Frame16: b't is a f'

Frame17:

Frame18: b'm A to B'

Frame19: b'instein.'

Frame20: b't is a f'

æ‰¾åˆ°æœ‰æ„ä¹‰çš„å†…å®¹ä¹‹åå›å¤å‡ºæ¥æ˜æ–‡æ˜¯

final_secret = 

```
"My secret is a famous saying of Albert Einstein. That is \"Logic will get you from A to B. Imagination will take you everywhere.\""
```

## å››ã€å‚è€ƒæ–‡çŒ®

[1] Dan Boneh et al. Twenty years of attacks on the rsa cryptosystem. *Notices of the AMS*, 46(2):203â€“213, 1999. 2.1

[2] Don Coppersmith. Finding a small root of a univariate modular equation. In *International Conference on the Theory and Applications of Cryptographic Techniques*, pages 155â€“165. Springer, 1996.2.2.1

[3] Nicholas Howgrave-Graham. Finding small roots of univariate modular equations revisited. In *IMA International Conference on Cryptography and Coding*, pages 131â€“142. Springer, 1997. 2.3

[4] Arjen K Lenstra, Hendrik Willem Lenstra, and LÃ¡szlÃ³ LovÃ¡sz. Factoring polynomials with rational coefffficients. *Mathematische annalen*, 261(ARTICLE):515â€“534, 1982. 2.2.1

[5] Ronald L Rivest, Adi Shamir, and Leonard Adleman. A method for obtaining digital signatures and public-key cryptosystems. *Communications of the ACM*, 21(2):120â€“126, 1978. 2.1

[6] H. P. Williams. Integer and combinatorial optimization. *Journal of the Operational Research Society*, 41(2):177â€“178, 1990. 2.3

[7] [ã€å¤§æ•°åˆ†è§£ã€‘Pollardâ€˜s p-1 method_éšç¼˜æ‡‚ç‚¹å¯†ç å­¦çš„åšå®¢-CSDNåšå®¢](https://blog.csdn.net/qq_42667481/article/details/106729900)

